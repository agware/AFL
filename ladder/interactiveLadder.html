<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Interactive Ladder</title>

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">

    <style>

        circle {
            fill: #fff;
            stroke-width: 2px;
            stroke: #000;
        }

        text {
            font-family: 'Open Sans', sans-serif;
            font-size: 18px;
            fill: #000;
        }

        .line {
            fill: none;
            stroke: steelblue;
            stroke-width: 10px;
        }

        .uncertain {
            fill-opacity: 0.5;
            stroke-opacity: 0.5;
        }

    </style>

</head>
<body>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script type="text/javascript" src="utils.js"></script>
<script type="text/javascript" src="rounds.js"></script>

<script>

    const height = 900;
    const width = 960;
    const margin = {'x': 140, 'y': 80, 'gapX': 90, 'gapY': 100};
    const teams = ['Adelaide', 'Brisbane', 'Bulldogs', 'Carlton', 'Collingwood', 'Fremantle', 'GWS', 'Melbourne'];
    const colour = {
        'Adelaide': '#ffe303',
        'Brisbane': '#b15928',
        'Bulldogs': '#1f78b4',
        'Carlton': '#253494',
        'Collingwood': '#000',
        'Fremantle': '#6a3d9a',
        'GWS': '#ff7f00',
        'Melbourne': '#e31a1c'
    };

    let points = {'Adelaide': 0, 'Brisbane': 0, 'Bulldogs': 0, 'Carlton': 0, 'Collingwood': 0, 'Fremantle': 0, 'GWS': 0, 'Melbourne': 0};

    // ToDo: shift into separate file for easy updating?
    const certainWin = [
        ['Adelaide', 'Brisbane', 'Bulldogs', 'Carlton'],
        ['Adelaide', 'Brisbane', 'Carlton', 'Melbourne'],
        ['Adelaide', 'Brisbane', 'Melbourne'],
        ['Adelaide', 'Brisbane', 'Collingwood', 'Melbourne']
    ];
    const certainDraw = [[],[],['Fremantle', 'GWS'],[]];

    let svg = d3.select('body').append('svg')
        .attr('height', height)
        .attr('width', width);

    let background = svg.append('g');
    background.append('rect')
        .attr('x', margin.x - 40)
        .attr('y', margin.y + 50)
        .attr('width', 170)
        .attr('height', 500)
        .style('fill', '#e8e8ee');


    let ladder = svg.append('g');

    let roundNum = 0;

    listClub();

    generateRound(roundNum);
    listRound(roundNum);
    roundNum += 1;

    while(roundNum <= certainWin.length) {

        addWin(certainWin[roundNum-1]);
        addDraw(certainDraw[roundNum-1]);
        sortByPoints();
        generateRound(roundNum);
        listRound(roundNum);

        roundNum += 1;
    }

    // Next round sidebar
    // Round roundNum
    // a vs b
    // c vs d
    // e vs f etc.




    // regenerate path each new round? Is this memory heavy?
    for (let x = 0; x < teams.length; x++) {
        let data = ripData(teams[x], certainWin.length);

        background.append('path')
            .datum(data)
            .classed('line', true)
            .style('stroke', colour[teams[x]])
            .attr('d', d3.line()
                .curve(d3.curveMonotoneY)
                .x(function(d) { return d.x; })
                .y(function(d) { return d.y; })
            );
    }

</script>

</body>
</html>